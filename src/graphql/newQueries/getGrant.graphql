fragment ProjectData on Project {
  id
  profileId
  name
  status
  owner
  metadata {
    pointer
  }
  members {
    addresses
  }
}

fragment GrantUpdate on Update {
  id
  tag
  playerType
  entityAddress
  postedBy
  message
  content {
    pointer
  }
  contentSchema
  timestamp
}

fragment GrantData on Grant {
  id
  status
  lastUpdated
  amount
  isAllocated
  grantCompleted
  applicationApproved
  milestoneDrafts {
    id
  }
  currentMilestones {
    id
  }
  applications {
    id
    metadata {
      pointer
    }
    amount
    receivingAddress
    status
    timestamp
  }
  currentApplication {
    id
  }
}

query getGrant($grantId: String!, $projectId: String!, $shipSrc: String!) {
  Project_by_pk(id: $projectId) {
    ...ProjectData
  }
  GrantShip(where: { shipContractAddress: { _eq: $shipSrc } }, limit: 1) {
    ...BaseShipData
    beaconMessage {
      pointer
    }
    customApplication {
      pointer
    }
  }
  Grant_by_pk(id: $grantId) {
    ...GrantData
  }
  Update(where: { hostEntityId: { _eq: $grantId } }) {
    ...GrantUpdate
  }
}
